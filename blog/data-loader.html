<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <link href="/static/styles.css" rel="stylesheet" />
    <script src="https://cdn.tailwindcss.com"></script>
    <title></title>
  </head>
  <body>
    <header>
      <div>
        <h2>
          
          <a color="inherit" href="/blog">tsoobame</a>
        </h2>
        <div class="navbar-links">
          
          <button
            tabindex="0"
            type="button"
            class="active"
            
          >
            <a href="/blog" color="inherit">blog</a>
          </button>
          
          <button
            tabindex="0"
            type="button"
            
          >
            <a href="/projects" color="inherit">projects</a>
          </button>
          
        </div>
      </div>
    </header>

    <div class="container mx-auto px-4 pt-8"><div class="mb-8">
  
  <div class="mb-4 text-end">
    <img
      src="https://res.cloudinary.com/ddkok43g3/image/upload/w_auto,h_400,c_fill,g_auto,q_auto,f_auto/v1747320153/data-loader.jpg"
      alt=""
      class="w-full h-[400px] object-cover rounded"
    />

    
    <div class="mt-2">
      
        <a
          href="tags/javascript.html"
          class="inline-block bg-[rgb(0,119,151)] text-white text-xs font-medium px-2 py-1 rounded me-1"
        >
          javascript
        </a>
      
        <a
          href="tags/dataloader.html"
          class="inline-block bg-[rgb(0,119,151)] text-white text-xs font-medium px-2 py-1 rounded me-1"
        >
          dataloader
        </a>
      
    </div>

    
    <small class="text-gray-500 text-sm mt-2 inline-block">
      Photo by
      <a
        href="https://unsplash.com/@larskienle?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText"
        class="underline hover:text-[rgb(0,119,151)]"
        target="_blank"
        rel="noopener noreferrer"
      >
        "Lars Kienle"
      </a>
    </small>
  </div>

  
  <article class="post-content">
    <h1 id="understanding-the-dataloader">Understanding the Dataloader</h1>
<p><a href="https://github.com/graphql/dataloader">Dataloader</a> is one of the packages I find more useful and smart from the ones I have in my toolbox.</p>
<p>In this post we are going to navigate a simple but complex enough example to find out the need for a Dataloader.<br />
After that we will implement a naive version of the dataloader to understand its beauty and how useful it is.</p>
<h2 id="about-the-project">About the project</h2>
<p>We have data about libraries and their dependencies. We want to implement a tool that renders the tree of dependencies of a given library.<br />
The tree should show the library and its dependencies, and the dependencies of the dependencies.</p>
<p>These are the dependencies of the libraries:</p>
<pre tabindex="0" style="background-color:#fff;"><code><span style="display:flex;"><span>WebRender depends on HttpClient, Utils, and Logger.
</span></span><span style="display:flex;"><span>HttpClient depends on NetworkTools and Logger.
</span></span><span style="display:flex;"><span>Utils depends on NetworkTools, CacheManager, and Logger.
</span></span><span style="display:flex;"><span>NetworkTools depends on Logger.
</span></span><span style="display:flex;"><span>CacheManager depends on Logger.
</span></span><span style="display:flex;"><span>DatabaseConnector depends on NetworkTools and CacheManager.
</span></span><span style="display:flex;"><span>AuthService depends on HttpClient and Logger.
</span></span><span style="display:flex;"><span>ApiGateway depends on HttpClient and DatabaseConnector.
</span></span><span style="display:flex;"><span>PaymentProcessor depends on DatabaseConnector and CacheManager.
</span></span><span style="display:flex;"><span>Logger has no dependencies (it&#39;s a foundational library).
</span></span></code></pre><p>In JSON format:</p>
<pre tabindex="0" style="background-color:#fff;"><code><span style="display:flex;"><span>[
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;name&#34;</span>: <span style="color:#d14">&#34;WebRender&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;version&#34;</span>: <span style="color:#d14">&#34;1.0.0&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;dependencies&#34;</span>: [
</span></span><span style="display:flex;"><span>      {
</span></span><span style="display:flex;"><span>        <span style="color:#000080">&#34;name&#34;</span>: <span style="color:#d14">&#34;HttpClient&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#000080">&#34;version&#34;</span>: <span style="color:#d14">&#34;2.1.0&#34;</span>
</span></span><span style="display:flex;"><span>      },
</span></span><span style="display:flex;"><span>      {
</span></span><span style="display:flex;"><span>        <span style="color:#000080">&#34;name&#34;</span>: <span style="color:#d14">&#34;Utils&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#000080">&#34;version&#34;</span>: <span style="color:#d14">&#34;3.0.0&#34;</span>
</span></span><span style="display:flex;"><span>      },
</span></span><span style="display:flex;"><span>      {
</span></span><span style="display:flex;"><span>        <span style="color:#000080">&#34;name&#34;</span>: <span style="color:#d14">&#34;Logger&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#000080">&#34;version&#34;</span>: <span style="color:#d14">&#34;1.2.0&#34;</span>
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    ]
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;name&#34;</span>: <span style="color:#d14">&#34;HttpClient&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;version&#34;</span>: <span style="color:#d14">&#34;2.1.0&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;dependencies&#34;</span>: [
</span></span><span style="display:flex;"><span>      {
</span></span><span style="display:flex;"><span>        <span style="color:#000080">&#34;name&#34;</span>: <span style="color:#d14">&#34;NetworkTools&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#000080">&#34;version&#34;</span>: <span style="color:#d14">&#34;1.5.0&#34;</span>
</span></span><span style="display:flex;"><span>      },
</span></span><span style="display:flex;"><span>      {
</span></span><span style="display:flex;"><span>        <span style="color:#000080">&#34;name&#34;</span>: <span style="color:#d14">&#34;Logger&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#000080">&#34;version&#34;</span>: <span style="color:#d14">&#34;1.2.0&#34;</span>
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    ]
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;name&#34;</span>: <span style="color:#d14">&#34;Utils&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;version&#34;</span>: <span style="color:#d14">&#34;3.0.0&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;dependencies&#34;</span>: [
</span></span><span style="display:flex;"><span>      {
</span></span><span style="display:flex;"><span>        <span style="color:#000080">&#34;name&#34;</span>: <span style="color:#d14">&#34;NetworkTools&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#000080">&#34;version&#34;</span>: <span style="color:#d14">&#34;1.5.0&#34;</span>
</span></span><span style="display:flex;"><span>      },
</span></span><span style="display:flex;"><span>      {
</span></span><span style="display:flex;"><span>        <span style="color:#000080">&#34;name&#34;</span>: <span style="color:#d14">&#34;CacheManager&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#000080">&#34;version&#34;</span>: <span style="color:#d14">&#34;4.2.0&#34;</span>
</span></span><span style="display:flex;"><span>      },
</span></span><span style="display:flex;"><span>      {
</span></span><span style="display:flex;"><span>        <span style="color:#000080">&#34;name&#34;</span>: <span style="color:#d14">&#34;Logger&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#000080">&#34;version&#34;</span>: <span style="color:#d14">&#34;1.2.0&#34;</span>
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    ]
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;name&#34;</span>: <span style="color:#d14">&#34;NetworkTools&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;version&#34;</span>: <span style="color:#d14">&#34;1.5.0&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;dependencies&#34;</span>: [
</span></span><span style="display:flex;"><span>      {
</span></span><span style="display:flex;"><span>        <span style="color:#000080">&#34;name&#34;</span>: <span style="color:#d14">&#34;Logger&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#000080">&#34;version&#34;</span>: <span style="color:#d14">&#34;1.2.0&#34;</span>
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    ]
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;name&#34;</span>: <span style="color:#d14">&#34;CacheManager&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;version&#34;</span>: <span style="color:#d14">&#34;4.2.0&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;dependencies&#34;</span>: [
</span></span><span style="display:flex;"><span>      {
</span></span><span style="display:flex;"><span>        <span style="color:#000080">&#34;name&#34;</span>: <span style="color:#d14">&#34;Logger&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#000080">&#34;version&#34;</span>: <span style="color:#d14">&#34;1.2.0&#34;</span>
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    ]
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;name&#34;</span>: <span style="color:#d14">&#34;DatabaseConnector&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;version&#34;</span>: <span style="color:#d14">&#34;2.4.0&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;dependencies&#34;</span>: [
</span></span><span style="display:flex;"><span>      {
</span></span><span style="display:flex;"><span>        <span style="color:#000080">&#34;name&#34;</span>: <span style="color:#d14">&#34;NetworkTools&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#000080">&#34;version&#34;</span>: <span style="color:#d14">&#34;1.5.0&#34;</span>
</span></span><span style="display:flex;"><span>      },
</span></span><span style="display:flex;"><span>      {
</span></span><span style="display:flex;"><span>        <span style="color:#000080">&#34;name&#34;</span>: <span style="color:#d14">&#34;CacheManager&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#000080">&#34;version&#34;</span>: <span style="color:#d14">&#34;4.2.0&#34;</span>
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    ]
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;name&#34;</span>: <span style="color:#d14">&#34;AuthService&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;version&#34;</span>: <span style="color:#d14">&#34;1.1.0&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;dependencies&#34;</span>: [
</span></span><span style="display:flex;"><span>      {
</span></span><span style="display:flex;"><span>        <span style="color:#000080">&#34;name&#34;</span>: <span style="color:#d14">&#34;HttpClient&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#000080">&#34;version&#34;</span>: <span style="color:#d14">&#34;2.1.0&#34;</span>
</span></span><span style="display:flex;"><span>      },
</span></span><span style="display:flex;"><span>      {
</span></span><span style="display:flex;"><span>        <span style="color:#000080">&#34;name&#34;</span>: <span style="color:#d14">&#34;Logger&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#000080">&#34;version&#34;</span>: <span style="color:#d14">&#34;1.2.0&#34;</span>
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    ]
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;name&#34;</span>: <span style="color:#d14">&#34;ApiGateway&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;version&#34;</span>: <span style="color:#d14">&#34;3.3.0&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;dependencies&#34;</span>: [
</span></span><span style="display:flex;"><span>      {
</span></span><span style="display:flex;"><span>        <span style="color:#000080">&#34;name&#34;</span>: <span style="color:#d14">&#34;HttpClient&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#000080">&#34;version&#34;</span>: <span style="color:#d14">&#34;2.1.0&#34;</span>
</span></span><span style="display:flex;"><span>      },
</span></span><span style="display:flex;"><span>      {
</span></span><span style="display:flex;"><span>        <span style="color:#000080">&#34;name&#34;</span>: <span style="color:#d14">&#34;DatabaseConnector&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#000080">&#34;version&#34;</span>: <span style="color:#d14">&#34;2.4.0&#34;</span>
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    ]
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;name&#34;</span>: <span style="color:#d14">&#34;PaymentProcessor&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;version&#34;</span>: <span style="color:#d14">&#34;5.1.0&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;dependencies&#34;</span>: [
</span></span><span style="display:flex;"><span>      {
</span></span><span style="display:flex;"><span>        <span style="color:#000080">&#34;name&#34;</span>: <span style="color:#d14">&#34;DatabaseConnector&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#000080">&#34;version&#34;</span>: <span style="color:#d14">&#34;2.4.0&#34;</span>
</span></span><span style="display:flex;"><span>      },
</span></span><span style="display:flex;"><span>      {
</span></span><span style="display:flex;"><span>        <span style="color:#000080">&#34;name&#34;</span>: <span style="color:#d14">&#34;CacheManager&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#000080">&#34;version&#34;</span>: <span style="color:#d14">&#34;4.2.0&#34;</span>
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    ]
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;name&#34;</span>: <span style="color:#d14">&#34;Logger&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;version&#34;</span>: <span style="color:#d14">&#34;1.2.0&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;dependencies&#34;</span>: []
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>]
</span></span></code></pre><p>This is the metadata of the libraries:</p>
<pre tabindex="0" style="background-color:#fff;"><code><span style="display:flex;"><span>[
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;name&#34;</span>: <span style="color:#d14">&#34;WebRender&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;owner&#34;</span>: <span style="color:#d14">&#34;WebDevCorp&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;repo_url&#34;</span>: <span style="color:#d14">&#34;https://github.com/WebDevCorp/WebRender&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;release_date&#34;</span>: <span style="color:#d14">&#34;2023-01-15&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;license&#34;</span>: <span style="color:#d14">&#34;MIT&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;maintainers&#34;</span>: [
</span></span><span style="display:flex;"><span>      <span style="color:#d14">&#34;Alice Johnson&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#d14">&#34;Bob Smith&#34;</span>
</span></span><span style="display:flex;"><span>    ]
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;name&#34;</span>: <span style="color:#d14">&#34;HttpClient&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;owner&#34;</span>: <span style="color:#d14">&#34;NetToolsInc&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;repo_url&#34;</span>: <span style="color:#d14">&#34;https://github.com/NetToolsInc/HttpClient&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;release_date&#34;</span>: <span style="color:#d14">&#34;2022-09-30&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;license&#34;</span>: <span style="color:#d14">&#34;Apache-2.0&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;maintainers&#34;</span>: [
</span></span><span style="display:flex;"><span>      <span style="color:#d14">&#34;Charlie Brown&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#d14">&#34;Dave White&#34;</span>
</span></span><span style="display:flex;"><span>    ]
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;name&#34;</span>: <span style="color:#d14">&#34;Utils&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;owner&#34;</span>: <span style="color:#d14">&#34;CoreUtils&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;repo_url&#34;</span>: <span style="color:#d14">&#34;https://github.com/CoreUtils/Utils&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;release_date&#34;</span>: <span style="color:#d14">&#34;2021-12-05&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;license&#34;</span>: <span style="color:#d14">&#34;GPL-3.0&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;maintainers&#34;</span>: [
</span></span><span style="display:flex;"><span>      <span style="color:#d14">&#34;Eve Green&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#d14">&#34;Frank Black&#34;</span>
</span></span><span style="display:flex;"><span>    ]
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;name&#34;</span>: <span style="color:#d14">&#34;NetworkTools&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;owner&#34;</span>: <span style="color:#d14">&#34;NetToolsInc&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;repo_url&#34;</span>: <span style="color:#d14">&#34;https://github.com/NetToolsInc/NetworkTools&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;release_date&#34;</span>: <span style="color:#d14">&#34;2021-08-22&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;license&#34;</span>: <span style="color:#d14">&#34;MIT&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;maintainers&#34;</span>: [
</span></span><span style="display:flex;"><span>      <span style="color:#d14">&#34;Grace Blue&#34;</span>
</span></span><span style="display:flex;"><span>    ]
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;name&#34;</span>: <span style="color:#d14">&#34;CacheManager&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;owner&#34;</span>: <span style="color:#d14">&#34;TechCore&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;repo_url&#34;</span>: <span style="color:#d14">&#34;https://github.com/TechCore/CacheManager&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;release_date&#34;</span>: <span style="color:#d14">&#34;2023-05-10&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;license&#34;</span>: <span style="color:#d14">&#34;MIT&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;maintainers&#34;</span>: [
</span></span><span style="display:flex;"><span>      <span style="color:#d14">&#34;Hannah Red&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#d14">&#34;Ivy Gold&#34;</span>
</span></span><span style="display:flex;"><span>    ]
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;name&#34;</span>: <span style="color:#d14">&#34;DatabaseConnector&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;owner&#34;</span>: <span style="color:#d14">&#34;DatabaseTech&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;repo_url&#34;</span>: <span style="color:#d14">&#34;https://github.com/DatabaseTech/DatabaseConnector&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;release_date&#34;</span>: <span style="color:#d14">&#34;2022-11-20&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;license&#34;</span>: <span style="color:#d14">&#34;Apache-2.0&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;maintainers&#34;</span>: [
</span></span><span style="display:flex;"><span>      <span style="color:#d14">&#34;Jack Silver&#34;</span>
</span></span><span style="display:flex;"><span>    ]
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;name&#34;</span>: <span style="color:#d14">&#34;AuthService&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;owner&#34;</span>: <span style="color:#d14">&#34;AuthCorp&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;repo_url&#34;</span>: <span style="color:#d14">&#34;https://github.com/AuthCorp/AuthService&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;release_date&#34;</span>: <span style="color:#d14">&#34;2023-03-14&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;license&#34;</span>: <span style="color:#d14">&#34;MIT&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;maintainers&#34;</span>: [
</span></span><span style="display:flex;"><span>      <span style="color:#d14">&#34;Kevin Purple&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#d14">&#34;Lily Orange&#34;</span>
</span></span><span style="display:flex;"><span>    ]
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;name&#34;</span>: <span style="color:#d14">&#34;ApiGateway&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;owner&#34;</span>: <span style="color:#d14">&#34;GatewayTech&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;repo_url&#34;</span>: <span style="color:#d14">&#34;https://github.com/GatewayTech/ApiGateway&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;release_date&#34;</span>: <span style="color:#d14">&#34;2022-07-01&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;license&#34;</span>: <span style="color:#d14">&#34;GPL-3.0&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;maintainers&#34;</span>: [
</span></span><span style="display:flex;"><span>      <span style="color:#d14">&#34;Mason Yellow&#34;</span>
</span></span><span style="display:flex;"><span>    ]
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;name&#34;</span>: <span style="color:#d14">&#34;PaymentProcessor&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;owner&#34;</span>: <span style="color:#d14">&#34;FinTechCo&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;repo_url&#34;</span>: <span style="color:#d14">&#34;https://github.com/FinTechCo/PaymentProcessor&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;release_date&#34;</span>: <span style="color:#d14">&#34;2023-02-17&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;license&#34;</span>: <span style="color:#d14">&#34;MIT&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;maintainers&#34;</span>: [
</span></span><span style="display:flex;"><span>      <span style="color:#d14">&#34;Nina Blue&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#d14">&#34;Oscar Grey&#34;</span>
</span></span><span style="display:flex;"><span>    ]
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;name&#34;</span>: <span style="color:#d14">&#34;Logger&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;owner&#34;</span>: <span style="color:#d14">&#34;LoggerTools&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;repo_url&#34;</span>: <span style="color:#d14">&#34;https://github.com/LoggerTools/Logger&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;release_date&#34;</span>: <span style="color:#d14">&#34;2020-04-10&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;license&#34;</span>: <span style="color:#d14">&#34;MIT&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;maintainers&#34;</span>: [
</span></span><span style="display:flex;"><span>      <span style="color:#d14">&#34;Paul Black&#34;</span>
</span></span><span style="display:flex;"><span>    ]
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>]
</span></span></code></pre><p>And this is the view we want to implement:<img src="https://raw.githubusercontent.com/tsoobame/dataloader/main/view.png" alt="View" /></p>
<h2 id="initial-setup">Initial Setup</h2>
<h3 id="create-the-package">Create the package</h3>
<pre tabindex="0" style="background-color:#fff;"><code><span style="display:flex;"><span>mkdir dataloader
</span></span><span style="display:flex;"><span><span style="color:#0086b3">cd</span> dataloader
</span></span><span style="display:flex;"><span>npm init -y
</span></span></code></pre><h3 id="install-express">Install express</h3>
<pre tabindex="0" style="background-color:#fff;"><code><span style="display:flex;"><span>npm install express
</span></span></code></pre><h3 id="make-the-package-a-module-to-allow-using-import">Make the package a module to allow using import</h3>
<p>We need to add</p>
<pre tabindex="0" style="background-color:#fff;"><code><span style="display:flex;"><span>  <span style="color:#d14">&#34;type&#34;</span><span style="color:#a61717;background-color:#e3d2d2">:</span> <span style="color:#d14">&#34;module&#34;</span><span style="color:#a61717;background-color:#e3d2d2">,</span>
</span></span></code></pre><p>to the package.json file.</p>
<h3 id="create-the-files">Create the files</h3>
<pre tabindex="0" style="background-color:#fff;"><code><span style="display:flex;"><span>touch src/index.js
</span></span></code></pre><h3 id="create-a-basic-server">Create a basic server</h3>
<pre tabindex="0" style="background-color:#fff;"><code><span style="display:flex;"><span><span style="color:#998;font-style:italic">// src/index.js
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">import</span> express from <span style="color:#d14">&#34;express&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">const</span> app <span style="color:#000;font-weight:bold">=</span> express();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>app.get(<span style="color:#d14">&#34;/&#34;</span>, (req, res) =&gt; {
</span></span><span style="display:flex;"><span>  res.send(<span style="color:#d14">&#34;Hello World&#34;</span>);
</span></span><span style="display:flex;"><span>});
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>app.listen(<span style="color:#099">3000</span>, () =&gt; {
</span></span><span style="display:flex;"><span>  console.log(<span style="color:#d14">&#34;Server is running on port 3000&#34;</span>);
</span></span><span style="display:flex;"><span>});
</span></span></code></pre><h3 id="run-the-server">Run the server</h3>
<pre tabindex="0" style="background-color:#fff;"><code><span style="display:flex;"><span>node src/index.js
</span></span></code></pre><h3 id="try-it-out">Try it out</h3>
<p>Open <a href="http://localhost:3000">http://localhost:3000</a> in your browser.</p>
<p>You should see &quot;Hello World&quot;.</p>
<h2 id="data">Data</h2>
<p>Save the data in json files like:</p>
<ul>
<li>data/dependencies.json</li>
<li>data/metadata.json</li>
</ul>
<h2 id="step-1-naive-implementation">Step 1: Naive implementation</h2>
<p>We are going to implement an endpoint (actually simulated) that returns the direct dependencies of one or more libraries.</p>
<p>Crete the file:</p>
<pre tabindex="0" style="background-color:#fff;"><code><span style="display:flex;"><span>touch src/libraryService.js
</span></span></code></pre><p>Implement a fake service that returns data based on the json files we just created.<br />
We are adding a delay to simulate a real service and we are logging the requests to the console<br />
for debugging reasons.</p>
<pre tabindex="0" style="background-color:#fff;"><code><span style="display:flex;"><span><span style="color:#998;font-style:italic">// src/libraryService.js
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">import</span> dependencies from <span style="color:#d14">&#34;../data/dependencies.json&#34;</span> <span style="color:#000;font-weight:bold">with</span> { type<span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#34;json&#34;</span> };
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">import</span> metadata from <span style="color:#d14">&#34;../data/metadata.json&#34;</span> <span style="color:#000;font-weight:bold">with</span> { type<span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#34;json&#34;</span> };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">const</span> sleep <span style="color:#000;font-weight:bold">=</span> (ms) =&gt; <span style="color:#000;font-weight:bold">new</span> <span style="color:#0086b3">Promise</span>((resolve) =&gt; setTimeout(resolve, ms));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">export</span> <span style="color:#000;font-weight:bold">async</span> <span style="color:#000;font-weight:bold">function</span> getDependencies(names) {
</span></span><span style="display:flex;"><span>  console.log(<span style="color:#000;font-weight:bold">new</span> <span style="color:#0086b3">Date</span>(), <span style="color:#d14">&#34;GET /dependencies?names=&#34;</span> <span style="color:#000;font-weight:bold">+</span> names.join(<span style="color:#d14">&#34;,&#34;</span>));
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">await</span> sleep(<span style="color:#099">200</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">return</span> names.map((name) =&gt; dependencies.find((d) =&gt; d.name <span style="color:#000;font-weight:bold">===</span> name));
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">export</span> <span style="color:#000;font-weight:bold">async</span> <span style="color:#000;font-weight:bold">function</span> getMetadata(names) {
</span></span><span style="display:flex;"><span>  console.log(<span style="color:#000;font-weight:bold">new</span> <span style="color:#0086b3">Date</span>(), <span style="color:#d14">&#34;GET /metadata?names=&#34;</span> <span style="color:#000;font-weight:bold">+</span> names.join(<span style="color:#d14">&#34;,&#34;</span>));
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">await</span> sleep(<span style="color:#099">200</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">return</span> names.map((name) =&gt; metadata.find((d) =&gt; d.name <span style="color:#000;font-weight:bold">===</span> name));
</span></span><span style="display:flex;"><span>}
</span></span></code></pre><p>Let's add our resolver:</p>
<pre tabindex="0" style="background-color:#fff;"><code><span style="display:flex;"><span>touch src/resolver.js
</span></span></code></pre><pre tabindex="0" style="background-color:#fff;"><code><span style="display:flex;"><span><span style="color:#998;font-style:italic">// src/resolver.js
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">import</span> { getDependencies, getMetadata } from <span style="color:#d14">&#34;./libraryService.js&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">export</span> <span style="color:#000;font-weight:bold">async</span> <span style="color:#000;font-weight:bold">function</span> getDependenciesWithMetadata(names) {
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">const</span> libs <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">await</span> getDependencies(names);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">for</span> (<span style="color:#000;font-weight:bold">const</span> lib <span style="color:#000;font-weight:bold">of</span> libs) {
</span></span><span style="display:flex;"><span>    lib.metadata <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">await</span> getMetadata(lib.dependencies.map((d) =&gt; d.name));
</span></span><span style="display:flex;"><span>    lib.dependencies <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">await</span> getMetadata(
</span></span><span style="display:flex;"><span>      lib.dependencies.map((dep) =&gt; dep.name)
</span></span><span style="display:flex;"><span>    );
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">return</span> libs;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre><p>Let's add a new endpoint to our server that returns the dependencies of a library:</p>
<pre tabindex="0" style="background-color:#fff;"><code><span style="display:flex;"><span><span style="color:#998;font-style:italic">// src/index.js
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">import</span> { getDependenciesWithMetadata } from <span style="color:#d14">&#34;./resolver.js&#34;</span>;
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>app.get(<span style="color:#d14">&#34;/dependencies&#34;</span>, <span style="color:#000;font-weight:bold">async</span> (req, res) =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">const</span> names <span style="color:#000;font-weight:bold">=</span> req.query.names.split(<span style="color:#d14">&#34;,&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">const</span> libs <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">await</span> getDependenciesWithMetadata(names);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  res.json(libs);
</span></span><span style="display:flex;"><span>});
</span></span><span style="display:flex;"><span>...
</span></span></code></pre><p>Let's test it:</p>
<pre tabindex="0" style="background-color:#fff;"><code><span style="display:flex;"><span>curl <span style="color:#d14">&#34;http://localhost:3000/dependencies?names=WebRender,HttpClient&#34;</span>
</span></span></code></pre><p>You should see the dependencies of WebRender and HttpClient.<br />
The log of the server will show:</p>
<pre tabindex="0" style="background-color:#fff;"><code><span style="display:flex;"><span>2025-02-05T17:13:27.910Z GET /dependencies?names=WebRender,HttpClient
</span></span><span style="display:flex;"><span>2025-02-05T17:13:28.113Z GET /metadata?names=HttpClient,Utils,Logger
</span></span><span style="display:flex;"><span>2025-02-05T17:13:28.317Z GET /metadata?names=HttpClient,Utils,Logger
</span></span><span style="display:flex;"><span>2025-02-05T17:13:28.519Z GET /metadata?names=NetworkTools,Logger
</span></span><span style="display:flex;"><span>2025-02-05T17:13:28.722Z GET /metadata?names=NetworkTools,Logger
</span></span></code></pre><h3 id="datasourcejs">datasource.js</h3>
<p>The datasource allows us to retrieve one or multiple users by id. Contract is not random, it is already based on the real dataloader so there will be minimal changes over the course of the post. Data is defined in a file within the project. Code is pretty simple:</p>
<pre tabindex="0" style="background-color:#fff;"><code><span style="display:flex;"><span><span style="color:#000;font-weight:bold">const</span> users <span style="color:#000;font-weight:bold">=</span> require(<span style="color:#d14">&#34;./users.json&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">const</span> getUsersFromFile <span style="color:#000;font-weight:bold">=</span> (ids) =&gt;
</span></span><span style="display:flex;"><span>  ids.map((id) =&gt; users.find((u) =&gt; u.id <span style="color:#000;font-weight:bold">===</span> id));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">const</span> sleep <span style="color:#000;font-weight:bold">=</span> (ms) =&gt; <span style="color:#000;font-weight:bold">new</span> <span style="color:#0086b3">Promise</span>((resolve) =&gt; setTimeout(resolve, ms));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">async</span> <span style="color:#000;font-weight:bold">function</span> loadMany(ids) {
</span></span><span style="display:flex;"><span>  console.log(<span style="color:#d14">`GET /users?ids=</span><span style="color:#d14">${</span>ids<span style="color:#d14">}</span><span style="color:#d14">`</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">await</span> sleep(<span style="color:#099">100</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">return</span> getUsersFromFile(ids);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">async</span> <span style="color:#000;font-weight:bold">function</span> load(id) {
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">const</span> results <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">await</span> loadMany([id]);
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">return</span> results[<span style="color:#099">0</span>];
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>module.exports <span style="color:#000;font-weight:bold">=</span> {
</span></span><span style="display:flex;"><span>  load,
</span></span><span style="display:flex;"><span>  loadMany,
</span></span><span style="display:flex;"><span>};
</span></span></code></pre><p>The only interesting method is loadMany. We will print the requests to the simulated service so we can check the console. There will be a delay to resolve the promise, so we can simulate better and understand why dataloader is so good.</p>
<p>A very important requirement is that data needs to be returned to the caller in the right order and all elements need to be returned (same length of ids and results arrays). This will be clear when we put in place the dataloader.</p>
<h3 id="resolverjs">resolver.js</h3>
<p>Resolver will use the datasource received by parameter to load friendship data about users. It can receive the levels of friends we want to get, so it will use a recursive approach to load friends of friends until all levels are fetched.</p>
<pre tabindex="0" style="background-color:#fff;"><code><span style="display:flex;"><span><span style="color:#000;font-weight:bold">async</span> <span style="color:#000;font-weight:bold">function</span> getFriends(datasource, user, levels) {
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">if</span> (levels <span style="color:#000;font-weight:bold">==</span> <span style="color:#099">0</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">return</span> { id<span style="color:#000;font-weight:bold">:</span> user.id, name<span style="color:#000;font-weight:bold">:</span> user.name };
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">const</span> friends <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">await</span> datasource.loadMany(user.friends);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">return</span> {
</span></span><span style="display:flex;"><span>    ...user,
</span></span><span style="display:flex;"><span>    friends<span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">await</span> <span style="color:#0086b3">Promise</span>.all(
</span></span><span style="display:flex;"><span>      friends.map((f) =&gt; getFriends(datasource, f, levels <span style="color:#000;font-weight:bold">-</span> <span style="color:#099">1</span>))
</span></span><span style="display:flex;"><span>    ),
</span></span><span style="display:flex;"><span>  };
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">async</span> <span style="color:#000;font-weight:bold">function</span> getUserWithFriends(datasource, id, levels <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">1</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">const</span> user <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">await</span> datasource.load(id);
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">return</span> getFriends(datasource, user, levels);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>module.exports <span style="color:#000;font-weight:bold">=</span> { getUserWithFriends };
</span></span></code></pre><p>It uses a brute force approach on purpose. The code is simple but far away from being optimal. In one method it looks obvious, but sometimes, when we are building graphql or similar apis, or complex workflows we might be doing exactly this kind of brute force requests.</p>
<h3 id="viewjs">view.js</h3>
<p>Nothing advanced. Just render users friends in a nested way.</p>
<pre tabindex="0" style="background-color:#fff;"><code><span style="display:flex;"><span><span style="color:#000;font-weight:bold">function</span> render(user) {
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">return</span> <span style="color:#d14">`&lt;div style=&#34;padding-left: 12px;background-color:#def&#34;&gt; </span><span style="color:#d14">${</span>user.name<span style="color:#d14">}</span><span style="color:#d14"> </span><span style="color:#d14">${</span>
</span></span><span style="display:flex;"><span>    user.friends <span style="color:#000;font-weight:bold">?</span> user.friends.map((u) =&gt; render(u)).join(<span style="color:#d14">&#34;&#34;</span>) <span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#d14">}</span><span style="color:#d14"> &lt;/div&gt;`</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>module.exports <span style="color:#000;font-weight:bold">=</span> {
</span></span><span style="display:flex;"><span>  render,
</span></span><span style="display:flex;"><span>};
</span></span></code></pre><h3 id="serverjs">server.js</h3>
<pre tabindex="0" style="background-color:#fff;"><code><span style="display:flex;"><span><span style="color:#000;font-weight:bold">const</span> express <span style="color:#000;font-weight:bold">=</span> require(<span style="color:#d14">&#34;express&#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">const</span> PORT <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">3000</span>;
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">const</span> app <span style="color:#000;font-weight:bold">=</span> express();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">const</span> datasource <span style="color:#000;font-weight:bold">=</span> require(<span style="color:#d14">&#34;./datasource&#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">const</span> resolver <span style="color:#000;font-weight:bold">=</span> require(<span style="color:#d14">&#34;./resolver&#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">const</span> view <span style="color:#000;font-weight:bold">=</span> require(<span style="color:#d14">&#34;./view&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>app.get(<span style="color:#d14">`/user-with-friends/:id`</span>, <span style="color:#000;font-weight:bold">async</span> (req, res) =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">const</span> id <span style="color:#000;font-weight:bold">=</span> req.params.id;
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">const</span> levels <span style="color:#000;font-weight:bold">=</span> req.query.levels <span style="color:#000;font-weight:bold">||</span> <span style="color:#099">1</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">const</span> user <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">await</span> resolver.getUserWithFriends(datasource, id, levels);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  res.send(view.render(user));
</span></span><span style="display:flex;"><span>});
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>app.listen(PORT, () =&gt; console.log(<span style="color:#d14">`Fakebook listening to </span><span style="color:#d14">${</span>PORT<span style="color:#d14">}</span><span style="color:#d14">`</span>));
</span></span></code></pre><h2 id="run">Run</h2>
<pre tabindex="0" style="background-color:#fff;"><code><span style="display:flex;"><span>node index.js
</span></span></code></pre><h2 id="test-1">Test 1</h2>
<p>We will render friends of user 1. Only 1 level:</p>
<pre tabindex="0" style="background-color:#fff;"><code><span style="display:flex;"><span>http://localhost:3000/user-with-friends/1
</span></span></code></pre><p>If we check in our console we will find:</p>
<pre tabindex="0" style="background-color:#fff;"><code><span style="display:flex;"><span>GET /users?ids=1
</span></span><span style="display:flex;"><span>GET /users?ids=2,3
</span></span></code></pre><p>All good. We requested user 1 and their friends 2 and 3.</p>
<h2 id="test-2">Test 2</h2>
<p>Let's try by loading 3 levels:</p>
<pre tabindex="0" style="background-color:#fff;"><code><span style="display:flex;"><span>http://localhost:3000/user-with-friends/1?levels=3
</span></span></code></pre><p>Things are getting interesting here:</p>
<pre tabindex="0" style="background-color:#fff;"><code><span style="display:flex;"><span>GET /users?ids=1
</span></span><span style="display:flex;"><span>GET /users?ids=2,3
</span></span><span style="display:flex;"><span>GET /users?ids=1,3
</span></span><span style="display:flex;"><span>GET /users?ids=1,2,4
</span></span><span style="display:flex;"><span>GET /users?ids=2,3
</span></span><span style="display:flex;"><span>GET /users?ids=1,2,4
</span></span><span style="display:flex;"><span>GET /users?ids=2,3
</span></span><span style="display:flex;"><span>GET /users?ids=1,3
</span></span><span style="display:flex;"><span>GET /users?ids=3,5
</span></span></code></pre><p>We are loading data for users 1,2,3,4,5 but we are doing 9 requests. We are requesting the same users again and again. We could easily improve the situation adding some sort of cache per request.</p>
<p>Cache per request<br />
We are going to add a cache to the system. It will be empty at the start of each request, so we do not need to worry about expirations. The benefits will be:</p>
<p>Do not request the same resource twice to the remote source during the same request.<br />
As side effect, if we try to get the same resource twice during the same request, we will get the same data. So mutations of the resources in between a request will not provide incoherent results.</p>
<h3 id="cachejs">cache.js</h3>
<p>Simple cache implementation:</p>
<pre tabindex="0" style="background-color:#fff;"><code><span style="display:flex;"><span><span style="color:#000;font-weight:bold">function</span> make(loadManyFn) {
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">const</span> cache <span style="color:#000;font-weight:bold">=</span> {};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">async</span> <span style="color:#000;font-weight:bold">function</span> loadMany(ids) {
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">const</span> notCachedIds <span style="color:#000;font-weight:bold">=</span> ids.filter((id) =&gt; <span style="color:#000;font-weight:bold">!</span>cache[id]);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">if</span> (notCachedIds.length <span style="color:#000;font-weight:bold">&gt;</span> <span style="color:#099">0</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">const</span> results <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">await</span> loadManyFn(notCachedIds);
</span></span><span style="display:flex;"><span>      notCachedIds.forEach((id, idx) =&gt; (cache[id] <span style="color:#000;font-weight:bold">=</span> results[idx]));
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">return</span> ids.map((id) =&gt; cache[id]);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">return</span> {
</span></span><span style="display:flex;"><span>    load<span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">async</span> (id) =&gt; {
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">const</span> results <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">await</span> loadMany([id]);
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">return</span> results[<span style="color:#099">0</span>];
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    loadMany,
</span></span><span style="display:flex;"><span>  };
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>module.exports <span style="color:#000;font-weight:bold">=</span> { make };
</span></span></code></pre><p>Cache needs a function to retrieve multiple data by id (or in general by a key). It will check the data that is cached and request only the ids that are not found.</p>
<p>Implements the same contract as datasource.</p>
<h3 id="serverjs-1">server.js</h3>
<p>Let's add this line to the server:</p>
<pre tabindex="0" style="background-color:#fff;"><code><span style="display:flex;"><span><span style="color:#000;font-weight:bold">const</span> cache <span style="color:#000;font-weight:bold">=</span> require(<span style="color:#d14">&#39;./cache&#39;</span>)
</span></span><span style="display:flex;"><span>And replace <span style="color:#000;font-weight:bold">this</span> line<span style="color:#000;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">const</span> user <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">await</span> resolver.getUserWithFriends(datasource, id, levels)
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">with</span><span style="color:#000;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">const</span> user <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">await</span> resolver.getUserWithFriends(cache.make(datasource.loadMany), id, levels)
</span></span></code></pre><h2 id="run-1">Run</h2>
<p>Let's run again the server and test the previous request:</p>
<pre tabindex="0" style="background-color:#fff;"><code><span style="display:flex;"><span>http://localhost:3000/user-with-friends/1?levels=3
</span></span></code></pre><pre tabindex="0" style="background-color:#fff;"><code><span style="display:flex;"><span>GET /users?ids=1
</span></span><span style="display:flex;"><span>GET /users?ids=2,3
</span></span><span style="display:flex;"><span>GET /users?ids=4
</span></span><span style="display:flex;"><span>GET /users?ids=4
</span></span><span style="display:flex;"><span>GET /users?ids=5
</span></span></code></pre><p>We could reduce the number of requests from 9 to 5, which is pretty good. But, what a momentwhat happened here? Why are we requesting id=4 twice?</p>
<p>If we unnest the request flow based on how nodejs works (and how we implemented our resolver) this is what happened:</p>
<pre tabindex="0" style="background-color:#fff;"><code><span style="display:flex;"><span>1 - Load user 1 =&gt; GET /users?ids=1
</span></span><span style="display:flex;"><span>2 - Load friends of 1: [2,3]=&gt; GET /users?ids=2,3
</span></span><span style="display:flex;"><span>3.1. Load friends of 2: [1,3] =&gt; all cached
</span></span><span style="display:flex;"><span>4.1. Load friends of 1 : [2,3] =&gt; all cached
</span></span><span style="display:flex;"><span>4.2. Load friends of 3 : [1,2,4] =&gt; GET /users?ids=4
</span></span><span style="display:flex;"><span>3.2. Load friends of 3: [1,2,4] =&gt; GET /users?ids=4
</span></span><span style="display:flex;"><span>4.3. Load friends of 1: [2,3] =&gt; all cached
</span></span><span style="display:flex;"><span>4.4. Load friends of 2: [1,3] =&gt; all cached
</span></span><span style="display:flex;"><span>4.5. Load friends of 4: [3,5] =&gt; GET /users?ids=5
</span></span><span style="display:flex;"><span>On 3.1 we had all friends of user 2 cached. So the code was straight to 4.2, than ran in parallel with 3.2. Both were waiting for the same user (4) and therefore made the same requests twice.
</span></span></code></pre><p>So with our simple cache, we did not reduce the requests to the minimun we wanted.</p>
<p>For example, if we did:</p>
<pre tabindex="0" style="background-color:#fff;"><code><span style="display:flex;"><span><span style="color:#000;font-weight:bold">const</span> users <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">await</span> <span style="color:#0086b3">Promise</span>.all(load(<span style="color:#099">1</span>), load(<span style="color:#099">1</span>));
</span></span></code></pre><p>There would be 2 requests before the cache has data for id=1.</p>
<p>Let's fix this and produce the ideal:</p>
<pre tabindex="0" style="background-color:#fff;"><code><span style="display:flex;"><span>GET /users?ids=1
</span></span><span style="display:flex;"><span>GET /users?ids=2,3
</span></span><span style="display:flex;"><span>GET /users?ids=4
</span></span><span style="display:flex;"><span>GET /users?ids=5
</span></span></code></pre><h2 id="dataloader">Dataloader</h2>
<p>Using nodejs <code>process.nextTick(...)</code> we can postpone the execution of a given function to the end of the current event loop cycle. It is useful to run a given function after all variables are initialized for example.</p>
<p>From nodejs documentation:</p>
<pre tabindex="0" style="background-color:#fff;"><code><span style="display:flex;"><span>By using process.nextTick() we guarantee that apiCall() always runs its callback after the rest of the user&#39;s code and before the event loop is allowed to proceed.
</span></span></code></pre><p>Using it we can accumulate all the keys that are being requested during the same cycle (3.2 and 4.2 in the example above) and request them at the end. In the next cycle we would accumulate again the ones that were depending in the previous ones and so on.</p>
<p>This simple version of dataloader incorporates also code to accomplish the cache:</p>
<pre tabindex="0" style="background-color:#fff;"><code><span style="display:flex;"><span><span style="color:#000;font-weight:bold">function</span> make(loadManyFn) {
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">const</span> cache <span style="color:#000;font-weight:bold">=</span> {};
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">let</span> pending <span style="color:#000;font-weight:bold">=</span> [];
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">let</span> scheduled <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">false</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">function</span> scheduleSearch() {
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">if</span> (pending.length <span style="color:#000;font-weight:bold">&gt;</span> <span style="color:#099">0</span> <span style="color:#000;font-weight:bold">&amp;&amp;</span> <span style="color:#000;font-weight:bold">!</span>scheduled) {
</span></span><span style="display:flex;"><span>      scheduled <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">true</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#0086b3">Promise</span>.resolve().then(() =&gt;
</span></span><span style="display:flex;"><span>        process.nextTick(<span style="color:#000;font-weight:bold">async</span> () =&gt; {
</span></span><span style="display:flex;"><span>          <span style="color:#000;font-weight:bold">await</span> runSearch();
</span></span><span style="display:flex;"><span>          scheduled <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">false</span>;
</span></span><span style="display:flex;"><span>        })
</span></span><span style="display:flex;"><span>      );
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">async</span> <span style="color:#000;font-weight:bold">function</span> runSearch() {
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">const</span> pendingCopy <span style="color:#000;font-weight:bold">=</span> pending.splice(<span style="color:#099">0</span>, pending.length);
</span></span><span style="display:flex;"><span>    pending <span style="color:#000;font-weight:bold">=</span> [];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">if</span> (pendingCopy.length <span style="color:#000;font-weight:bold">&gt;</span> <span style="color:#099">0</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">const</span> results <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">await</span> loadManyFn(pendingCopy.map((p) =&gt; p.id));
</span></span><span style="display:flex;"><span>      pendingCopy.forEach(({ resolve }, idx) =&gt; resolve(results[idx]));
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">async</span> <span style="color:#000;font-weight:bold">function</span> loadMany(ids) {
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">const</span> notCachedIds <span style="color:#000;font-weight:bold">=</span> ids.filter((id) =&gt; <span style="color:#000;font-weight:bold">!</span>cache[id]);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">if</span> (notCachedIds.length <span style="color:#000;font-weight:bold">&gt;</span> <span style="color:#099">0</span>) {
</span></span><span style="display:flex;"><span>      notCachedIds.map((id) =&gt; {
</span></span><span style="display:flex;"><span>        cache[id] <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">new</span> <span style="color:#0086b3">Promise</span>((resolve) =&gt; {
</span></span><span style="display:flex;"><span>          pending.push({ id, resolve });
</span></span><span style="display:flex;"><span>        });
</span></span><span style="display:flex;"><span>      });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      scheduleSearch();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">return</span> <span style="color:#0086b3">Promise</span>.all(ids.map((id) =&gt; cache[id]));
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">return</span> {
</span></span><span style="display:flex;"><span>    load<span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">async</span> (id) =&gt; {
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">const</span> results <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">await</span> loadMany([id]);
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">return</span> results[<span style="color:#099">0</span>];
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    loadMany,
</span></span><span style="display:flex;"><span>  };
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>module.exports <span style="color:#000;font-weight:bold">=</span> { make };
</span></span></code></pre><p>Ignoring the part of the cache, the important bits are:</p>
<h3 id="accumulating-requests">Accumulating requests</h3>
<pre tabindex="0" style="background-color:#fff;"><code><span style="display:flex;"><span>notCachedIds.map((id) =&gt; {
</span></span><span style="display:flex;"><span>  cache[id] <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">new</span> <span style="color:#0086b3">Promise</span>((resolve) =&gt; {
</span></span><span style="display:flex;"><span>    pending.push({ id, resolve });
</span></span><span style="display:flex;"><span>  });
</span></span><span style="display:flex;"><span>});
</span></span></code></pre><p>We will add to the list of pending ids the ones that are not cached. We will keep the id and the resolve method, so we can resolve them afterwards with the right value. We cache the promise itself in the hashmap. This would allow us to cache also rejected promises for example. So we do not request over and over the same rejection. It is not used in this implementation, though.</p>
<h3 id="scheduling-the-request">Scheduling the request</h3>
<pre tabindex="0" style="background-color:#fff;"><code><span style="display:flex;"><span><span style="color:#000;font-weight:bold">function</span> scheduleSearch() {
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">if</span> (pending.length <span style="color:#000;font-weight:bold">&gt;</span> <span style="color:#099">0</span> <span style="color:#000;font-weight:bold">&amp;&amp;</span> <span style="color:#000;font-weight:bold">!</span>scheduled) {
</span></span><span style="display:flex;"><span>    scheduled <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">true</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#0086b3">Promise</span>.resolve().then(() =&gt;
</span></span><span style="display:flex;"><span>      process.nextTick(<span style="color:#000;font-weight:bold">async</span> () =&gt; {
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">await</span> runSearch();
</span></span><span style="display:flex;"><span>        scheduled <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">false</span>;
</span></span><span style="display:flex;"><span>      })
</span></span><span style="display:flex;"><span>    );
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre><p>That is where the magic happens. This function is short but is the most important one: We schedule/delay the request to the end of all the promises declarations.</p>
<h3 id="executing-the-search">Executing the search</h3>
<pre tabindex="0" style="background-color:#fff;"><code><span style="display:flex;"><span><span style="color:#000;font-weight:bold">async</span> <span style="color:#000;font-weight:bold">function</span> runSearch() {
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">const</span> pendingCopy <span style="color:#000;font-weight:bold">=</span> pending.splice(<span style="color:#099">0</span>, pending.length);
</span></span><span style="display:flex;"><span>  pending <span style="color:#000;font-weight:bold">=</span> [];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">if</span> (pendingCopy.length <span style="color:#000;font-weight:bold">&gt;</span> <span style="color:#099">0</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">const</span> results <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">await</span> loadManyFn(pendingCopy.map((p) =&gt; p.id));
</span></span><span style="display:flex;"><span>    pendingCopy.forEach(({ resolve }, idx) =&gt; resolve(results[idx]));
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre><p>Clone the ids (so they can be accumulated again after the search completes) and call the loadManyFn so we can resolve the promises we had pending. Remember the requirements of loadMany to return the data in the right order and all the elements ? This is where it is needed. We can reference the results by index and resolve the right pending promises.</p>
<p>Let's run it!</p>
<h2 id="execution">Execution</h2>
<p>Again the same request:</p>
<pre tabindex="0" style="background-color:#fff;"><code><span style="display:flex;"><span>http://localhost:3000/user-with-friends/1?levels=3
</span></span></code></pre><p>That produces the following output:</p>
<pre tabindex="0" style="background-color:#fff;"><code><span style="display:flex;"><span>GET /users?ids=1
</span></span><span style="display:flex;"><span>GET /users?ids=2,3
</span></span><span style="display:flex;"><span>GET /users?ids=4
</span></span><span style="display:flex;"><span>GET /users?ids=5
</span></span></code></pre><p>Exactly what we wanted.</p>
<h2 id="conclusion">Conclusion</h2>
<ul>
<li>
<p>Dataloader is a great package that should be in all developers toolbox. Specially the ones implementing Graphql or similar Apis.</p>
</li>
<li>
<p>The resolvers in this example could be optimized but sometimes our requests are on different files at different levels that depend on some conditions. With Dataloader we can keep our file structure and code readability without damaging our performance, both on response time to our client and on number of requests spawn within our mesh.</p>
</li>
</ul>
<p>Are you using Dataloader? Do you know any tool that accomplishes something similar? Do you now any other packages that in your opinion should be in all nodejs devs toolbox?</p>

  </article>
</div>
</div>

    <footer>
      <div>
        <p>&copy; 2025 tsoobame. All rights reserved.</p>
      </div>
    </footer>
  </body>
</html>
